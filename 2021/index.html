<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css?family=Merriweather:400,700" rel="stylesheet">
  <link href="/assets/main.css?build=2021-09-08T16-07" rel="stylesheet">
  <link rel="canonical" href="https://46b.it/2021/">
  <link rel="alternate" type="application/rss+xml" title="46b.it" href="/meta/feed.atom">

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-22921213-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-22921213-1');
  </script>
  <!-- $if(math)$
  <script src="/js/mathjax/MathJax.js?config=46bit"></script>
  $endif$ -->

  <title>46b.it</title>
</head>
<body>
  <header id="header">
    <div class="wrapper">
      <h1><a href="/"><img src="/assets/logo.png" alt="46b.it" width="75"></a></h1>
      <nav>
        
        <ul>
          <li ><a href="/art/">art</a></li>
          <li class="active"><a href="/writing/">writing</a></li>
          <li><a href="https://github.com/46bit">github</a></li>
          <li><a href="https://twitter.com/46bit">twitter</a></li>
        </ul>
      </nav>
    </div>
  </header>
  <article>
  <header class="prelude yellowlined">
    <div class="wrapper">
      <h1>Posts from 2021</h1>
    </div>
  </header>
  
<section class="wrapper zerotop yellowlined">
  <p class="meta">Sep 8, 2021</p>
  <h2 class="post-title"><a href="/2021/securing-pi-access-using-cloudflare/">Securing Pi access using free CloudFlare</a></h2>
  <p>I’ve recently been building an environment monitoring station at home using a Raspberry Pi 4B+. It turns out to be a remarkably powerful computer, much more than I remembered from earlier versions. I’ll write more another time about the environment side of things, but today I’m going to focus on how awesome the UX is when putting it behind Cloudflare.</p>

<p>This is the first time I’ve used Cloudflare for more than DNS, and it’s remarkable how much you can do for free. When I SSH to <code class="language-plaintext highlighter-rouge">pi.46bit.cloud</code>, I get redirected to a browser page to sign in – either with a one-time password emailed to me, or via Google OAuth. Only once that’s done can I actually finish SSHing. Cloudflare hides my actual home IP address and adds a strong boundary around accessing services externalyl.</p>

<p>You have to be hosting your DNS with Cloudflare for this to work. Once that’s done there are two parts to this:</p>

<ol>
  <li><strong>Connecting your host to Cloudflare:</strong> <a href="https://www.cloudflare.com/products/tunnel/">Argo Tunnel</a> connection outbound from my Pi to Cloudflare. This acts as a reverse proxy. Cloudflare forwards authenticated traffic to the Pi through this</li>
  <li><strong>Setup inside Cloudflare:</strong> A DNS entry pointing to a hostname identifying that tunnel, and then a <a href="https://www.cloudflare.com/teams/access/">Cloudflare Access</a> app telling Cloudflare what authentication to require.</li>
</ol>

<p>Setting up Argo Tunnel involves manual sysadmin on your Pi. Cloudflare provide <a href="https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/tunnel-guide">good instructions on setting up the tunnel</a>.</p>

<p>Cloudflare Access can be setup in Cloudflare’s web interface, but it’s exposed in their interface in a few different places. It’s easiest to configure it with Terraform. Here’s how to do it with the <a href="https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs">Cloudflare Terraform Provider</a>:</p>

<div class="language-terraform highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">variable</span> <span class="s2">"cloudflare_account_id"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="p">=</span> <span class="s2">"Provide your Cloudflare account ID (a 20-ish character string)"</span>
<span class="p">}</span>

<span class="c1"># Change `46bit.cloud` to the name of your domain (DNS must be hosted in free Cloudflare)</span>
<span class="k">resource</span> <span class="s2">"cloudflare_zone"</span> <span class="s2">"_46bit_cloud"</span> <span class="p">{</span>
  <span class="nx">zone</span> <span class="p">=</span> <span class="s2">"46bit.cloud"</span>
  <span class="nx">plan</span> <span class="p">=</span> <span class="s2">"free"</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"cloudflare_record"</span> <span class="s2">"pi"</span> <span class="p">{</span>
  <span class="nx">zone_id</span> <span class="p">=</span> <span class="nx">cloudflare_zone</span><span class="p">.</span><span class="nx">_46bit_cloud</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">type</span>    <span class="p">=</span> <span class="s2">"CNAME"</span>
  <span class="nx">proxied</span> <span class="p">=</span> <span class="kc">true</span>

  <span class="c1"># Change `pi` to the subdomain you want to use</span>
  <span class="nx">name</span>  <span class="p">=</span> <span class="s2">"pi"</span>
  <span class="c1"># Change this to reflect the ID of your Argo Tunnel</span>
  <span class="nx">value</span> <span class="p">=</span> <span class="s2">"GUID-GOES-HERE.cfargotunnel.com"</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"cloudflare_access_application"</span> <span class="s2">"pi"</span> <span class="p">{</span>
  <span class="nx">name</span> <span class="p">=</span> <span class="s2">"pi"</span>
  <span class="nx">account_id</span> <span class="p">=</span> <span class="kd">var</span><span class="p">.</span><span class="nx">cloudflare_account_id</span>

  <span class="c1"># Change this to the subdomain you want to use</span>
  <span class="nx">domain</span>           <span class="p">=</span> <span class="s2">"pi.46bit.cloud"</span>
  <span class="nx">type</span>             <span class="p">=</span> <span class="s2">"ssh"</span>
  <span class="nx">session_duration</span> <span class="p">=</span> <span class="s2">"24h"</span>

  <span class="nx">auto_redirect_to_identity</span> <span class="p">=</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"cloudflare_access_policy"</span> <span class="s2">"pi_email"</span> <span class="p">{</span>
  <span class="nx">name</span> <span class="p">=</span> <span class="s2">"Pi SSH access via email"</span>
  <span class="nx">account_id</span> <span class="p">=</span> <span class="kd">var</span><span class="p">.</span><span class="nx">cloudflare_account_id</span>

  <span class="nx">application_id</span> <span class="p">=</span> <span class="nx">cloudflare_access_application</span><span class="p">.</span><span class="nx">pi</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">precedence</span> <span class="p">=</span> <span class="s2">"1"</span>
  <span class="nx">decision</span>   <span class="p">=</span> <span class="s2">"allow"</span>

  <span class="nx">include</span> <span class="p">{</span>
    <span class="c1"># Change this to your email address domain</span>
    <span class="nx">email_domain</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"46b.it"</span><span class="p">,</span> <span class="s2">"46bit.com"</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>Once this is setup, visiting the domain will involve a check you can access an email account on that domain before you can proceed. For automatic access you can use <a href="https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/access_service_token">Service Tokens</a> (sadly mTLS isn’t supported in the free plan.)</p>

  <a class="read-more" href="/2021/securing-pi-access-using-cloudflare/">Continue reading&hellip;</a>
</section>

<section class="wrapper zerotop yellowlined">
  <p class="meta">Sep 2, 2021</p>
  <h2 class="post-title"><a href="/2021/choosing-to-focus-as-a-software-engineer/">Choosing a technical focus as a software engineer</a></h2>
  <p>Young technologists have a wonderful opportunity to explore. Software is involved in almost every company; <a href="https://a16z.com/2011/08/20/why-software-is-eating-the-world/">software ate the world</a>. Whether you’re a software engineer, data scientist or product manager you can work on more-or-less anything.</p>

  <a class="read-more" href="/2021/choosing-to-focus-as-a-software-engineer/">Continue reading&hellip;</a>
</section>

<section class="wrapper zerotop yellowlined">
  <p class="meta">Mar 12, 2021</p>
  <h2 class="post-title"><a href="/2021/finding-a-new-job-in-tech/">Finding a new job in tech</a></h2>
  <p>Inspired by <a href="https://www.toby.codes/posts/2021-02-Getting-a-job-in-tech-in-2021">Toby Lorne</a>, I wanted to share about my recent job hunt.</p>

<p>For the last four years I have been an engineer at <a href="https://gds.blog.gov.uk/about/">Government Digital Service</a> in London. My background is quite varied. At GDS I quickly became a DevOps expert and built, taught and operated infrastructure for <a href="https://www.cloud.service.gov.uk">cloud platforms</a>, <a href="https://www.payments.service.gov.uk">payment processing</a> and <a href="https://www.verify.service.gov.uk">digital identity</a>.</p>

<p>4 years is a long time to stay in one technology job, even with many different teams and projects. I have contributed to just about every service in GDS, and many elsewhere in government. I decided to find a new challenge elsewhere as my growth had slown down. I want to stay on the technical career track for the time being.</p>

<p>I have moved back to York as I wasn’t enjoying London during the pandemic. Quality of life here is excellent and I’m planning to stay. Remote roles are freely available.</p>

<h2 id="applications">Applications</h2>

<p>I applied for senior-level DevOps, SRE and software engineering, roles at these types of organisations:</p>

<ul>
  <li>Government: 1</li>
  <li>Cloud consulting: 1</li>
  <li>Mid- to late-stage startups: 4</li>
</ul>

<p>I got lots of interest from other teams in the Civil Service. I already know I can succeed there, and they already know what I’m capable of. But after 4 years I think it’s important to see somewhere else and keep learning. I ruled out large enterprises for the same reasons. I also ruled out finance for the time being to focus on quality-of-life.</p>

<p>I applied to several startups with problems that interest me. I have past experience with a small Y Combinator startup, and helping grow some larger startups. I’m sure I’ll go back into the startup world sooner or later.</p>

<p>I also interviewed with a cloud consultancy that I’ve known for quite a long time. I haven’t done consultancy before, although I’ve done a lot of freelancing and think consulting might suit me well.</p>

<p>All the roles I applied for were mostly- or fully-remote. This ruled out a few very competitive companies but not anywhere I was desperate to work at yet.</p>

<h2 id="progress">Progress</h2>

<p>Here’s a brief summary of how I progressed in the interviews:</p>

<table>
  <thead>
    <tr>
      <th>Stage</th>
      <th>Passed</th>
      <th>Rejected</th>
      <th>Withdrew</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Application</td>
      <td>6</td>
      <td>-</td>
      <td> </td>
    </tr>
    <tr>
      <td>CV Sift</td>
      <td>5</td>
      <td>1</td>
      <td> </td>
    </tr>
    <tr>
      <td>Phone screen</td>
      <td>4</td>
      <td> </td>
      <td>1</td>
    </tr>
    <tr>
      <td>Tech interviews</td>
      <td>3</td>
      <td> </td>
      <td>1</td>
    </tr>
    <tr>
      <td>Offer</td>
      <td>2</td>
      <td>1</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>I got responses from every application and ended up with two offers. I withdrew one application when I decided not to stay in government, and a second that was too far behind when I got offers.</p>

<h2 id="outcome">Outcome</h2>

<p>I had two offers to choose between: one from a late-stage startup and one from the cloud consulting company. Both were quite appealing and I was confident I’d grow from both.</p>

<p>I chose based on my favourite work. On <a href="https://www.cloud.service.gov.uk">GOV.UK PaaS</a> I have found myself helping services across government by solving incidents or advising on architecture. Consulting is a great way to get similar exposure in the private sector.</p>

<p><strong>Thus I’m excited to be joining <a href="https://www.engineerbetter.com">EngineerBetter</a> in early April to do cloud consulting and help transform companies.</strong></p>

<h2 id="retrospective">Retrospective</h2>

<p>I have a bunch of education and skills, but it felt terrible having a really good time during a pandemic that has hurt so many people.</p>

<p>Every company respected that I use <code class="language-plaintext highlighter-rouge">they/them</code> pronouns. I was very happy about this. Companies seem to be well into adjusting to the existence of non-binary staff.</p>

<p>It’s getting harder to find pure-technical roles that I think will challenge me. I’m not sure what to do after Senior, but sooner or later I’m going to be writing a lot less code and doing a lot more negotiation and planning.</p>

<p>Asking difficult <a href="https://leetcode.com/">LeetCode</a>-style Computer Science puzzles seems quite rare outside of finance, enterprise and Silicon Valley startups. These problems test abstract thought, but they also exclude people without a Computer Science education. I didn’t encounter any problems that I couldn’t solve.</p>

<p>Finding fully- or mostly-remote jobs was very easy. I’m no longer in London and don’t want to travel there every day. This was not a problem for any organisation I talked to. There’s some selection bias here in terms of the company culture that appeals to me. Remote salaries were quite similar to what I’d have targeted in London.</p>

<p>Having deep experience of both development and operations is extremely valuable right now. I wasn’t very surprised to receive multiple offers. I think I got bonus points for having taught infrastructure a lot in my current role.</p>

<p>Interviewing at Senior level feels easier than early-career. Expectations are higher but I have a lot of confidence and many deep experiences to draw on. I also have a bigger network for referrals and to ask questions. I imagine Staff level would still be hard.</p>

<p>Companies do a lot of interview stages. I had 20+ videocalls over two weeks. Scheduling these was very draining despite even though most companies have worldwide interviewers available at any convenient time. In hindsight I wished to have taken time off to find a new job.</p>

<p>Private sector salaries are much higher than government, yet Civil Service pensions are very valuable. Focusing on pensions doesn’t work for London’s housing market and that pushes a lot of people away.</p>

  <a class="read-more" href="/2021/finding-a-new-job-in-tech/">Continue reading&hellip;</a>
</section>

<section class="wrapper zerotop yellowlined">
  <p class="meta">Mar 5, 2021</p>
  <h2 class="post-title"><a href="/2021/getting-alerted-when-cycle-paths-flood-part-two/">Getting alerted when cycle paths flood: part two</a></h2>
  <p>I recently moved back to York, a city I absolutely love. One of the best things about living here is cycling. But York has two rivers, one of which brings rain from hills a long way away. Some of the best cycle routes can flood after rainfall when the rivers rise.</p>

  <a class="read-more" href="/2021/getting-alerted-when-cycle-paths-flood-part-two/">Continue reading&hellip;</a>
</section>

<section class="wrapper zerotop yellowlined">
  <p class="meta">Mar 4, 2021</p>
  <h2 class="post-title"><a href="/2021/getting-alerted-when-cycle-paths-flood/">Getting alerted when cycle paths flood</a></h2>
  <p>I recently moved back to York, a city I absolutely love. One of the best things about living here is cycling. But York has two rivers, one of which brings rain from hills a long way away. Some of the best cycle routes can flood after rainfall when the rivers rise.</p>

  <a class="read-more" href="/2021/getting-alerted-when-cycle-paths-flood/">Continue reading&hellip;</a>
</section>


</article>

</body>
</html>
